<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <Product Id="5BDEDA0E-AE75-48F9-8E33-27D725F2DCB6" Name="Gambit 13" Language="1033" Version="13.0.0" Manufacturer="The Gambit Project" UpgradeCode="CDF06BDB-F942-4588-874C-282E2BBB44F3">
        <Package Description="Gambit" Comments="Software Tools for Game Theory" InstallerVersion="200" Compressed="yes" />
        <Media Id="1" Cabinet="gambit.cab" EmbedCab="yes" />

        <WixVariable Id="WixUILicenseRtf" Value="license.rtf"/>
        <UI>
            <UIRef Id="WixUI_Minimal"/>
        </UI>

        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="ProgramFilesFolder">
                <Directory Id="ApplicationRootDirectory" Name="Gambit"/> 
            </Directory>
            <Directory Id="ProgramMenuFolder">
                <Directory Id="ApplicationProgramsFolder" Name="Gambit"/>
            </Directory>
        </Directory>

        <DirectoryRef Id="ApplicationRootDirectory">
            <Component Id="Gambit.exe" Guid="A292BA53-22E7-4DBD-B185-55D623CD4229">
                <File Id="gambit.exe" Source="installer\gambit.exe" KeyPath="yes" Checksum="yes"/>
                <File Id="gambit_enummixed.exe" Source="installer\gambit-enummixed.exe" Checksum="yes"/>
                <File Id="gambit_enumpoly.exe" Source="installer\gambit-enumpoly.exe" Checksum="yes"/>
                <File Id="gambit_enumpure.exe" Source="installer\gambit-enumpure.exe" Checksum="yes"/>
                <File Id="gambit_gnm.exe" Source="installer\gambit-gnm.exe" Checksum="yes"/>
                <File Id="gambit_ipa.exe" Source="installer\gambit-ipa.exe" Checksum="yes"/>
                <File Id="gambit_lcp.exe" Source="installer\gambit-lcp.exe" Checksum="yes"/>
                <File Id="gambit_liap.exe" Source="installer\gambit-liap.exe" Checksum="yes"/>
                <File Id="gambit_logit.exe" Source="installer\gambit-logit.exe" Checksum="yes"/>
                <File Id="gambit_lp.exe" Source="installer\gambit-lp.exe" Checksum="yes"/>
                <File Id="gambit_simpdiv.exe" Source="installer\gambit-simpdiv.exe" Checksum="yes"/>
            </Component>
        </DirectoryRef>

        <DirectoryRef Id="ProgramMenuFolder">
            <Directory Id="ProgramMenuDir" Name="Gambit 13">
                <Component Id="ProgramMenuDir" Guid="BA738777-7AD0-4D10-97D5-3B6292FC80C5">
                    <RemoveFolder Id="ProgramMenuDir" On="uninstall"/>
                    <RegistryValue Root="HKCU" Key="Software\Gambit\Gambit" Type="string" Value="" KeyPath="yes"/>
                </Component>
            </Directory>
        </DirectoryRef>

        <DirectoryRef Id="ApplicationProgramsFolder">
            <Component Id="ApplicationShortcut" Guid="2228FE1F-9345-4BCB-8AA7-364887E0A2F7">
                <Shortcut Id="ApplicationStartMenuShortcut"
                          Name="Gambit 13"
                          Description="Software Tools for Game Theory"
                          Target="[ApplicationRootDirectory]Gambit.exe"
                          WorkingDirectory="ApplicationRootDirectory"/>
                <Shortcut Id="UninstallProduct"
                          Name="Uninstall Gambit"
                          Description="Uninstalls Gambit"
                          Target="[System64Folder]msiexec.exe"
                          Arguments="/x [ProductCode]"/>
                <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall"/>
                <RegistryValue Root="HKCU" Key="Software\Microsoft\Gambit" Name="installed" Type="integer" Value="1" KeyPath="yes"/> 
            </Component>
        </DirectoryRef>
        <Feature Id="Complete" Level="1">
            <ComponentRef Id="Gambit.exe"/>
            <ComponentRef Id="ProgramMenuDir"/>
            <ComponentRef Id="ApplicationShortcut"/>
        </Feature>
    </Product>
</Wix>